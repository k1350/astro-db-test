---
import { Like, count, db, eq } from "astro:db";
import { LikeCountPresenter } from "./LikeCountPresenter";

const currentPath = Astro.url.pathname;
const likeCounts = await db
  .select({ count: count() })
  .from(Like)
  .where(eq(Like.url, currentPath));
const initialLikeCount = likeCounts.length > 0 ? likeCounts[0].count : 0;
---

<LikeCountPresenter 
  url={`${Astro.url.pathname}`} 
  initialLikeCount={initialLikeCount}
  client:load
/>
